# **Тезисы по статье "DGA Domain Detection using Deep Learning"**

## **1. Введение**
- Алгоритмы генерации доменов (DGA) используются злоумышленниками для создания псевдослучайных доменных имен, что позволяет избежать обнаружения и блокировки командно-контрольных серверов (C&C).
- Обратная разработка вредоносного ПО для выявления DGA и их семян позволяет обнаруживать подозрительные домены, но это трудоемкий процесс.
- Статистические методы требуют контекстной информации, которая не всегда доступна.
- Предлагается метод обнаружения DGA-доменов с использованием рекуррентных нейронных сетей (RNN), основанный исключительно на анализе доменного имени без необходимости в дополнительных данных.

## **2. Существующие методы**
- **Обратная разработка**: позволяет выявить алгоритмы DGA, но требует значительных временных затрат и может быть обойдена злоумышленниками.
- **Черные списки и sinkholing**: требуют знания DGA и их семян, а также значительных ресурсов на поддержку.
- **Методы машинного обучения**:
  - Кластеризация и ретроактивное обнаружение требуют контекстных данных (HTTP-заголовки, DNS-ответы и др.).
  - Методы, основанные на ручном извлечении признаков (например, длина строки, частота символов), подвержены обходу злоумышленниками.

## **3. Архитектура предложенной модели**
- Используются три варианта RNN: **LSTM**, **Bi-LSTM** и **GRU**.
- Входные данные: только второй уровень домена (например, "google" из "google.com").
- Архитектура состоит из:
  - Уровня векторизации символов (*embedding layer*).
  - RNN-слоя (LSTM, Bi-LSTM или GRU).
  - Полносвязного слоя.
  - Выходного узла с сигмоидной активацией для бинарной классификации (DGA / не DGA).

## **4. Экспериментальная часть**
- **Используемые наборы данных**:
  - *Benign (чистые)*: Alexa Top 1M, Cisco Umbrella.
  - *DGA-домены*: OSINT DGA Feed (Bambenek Consulting), Netlab 360.
- **Общее количество образцов**: более 2 млн доменов.
- **Доля данных**: 80% - обучение, 10% - валидация, 10% - тестирование.
- **Оптимизатор**: *RMSprop* (лучше, чем Adam).
- **Количество эпох**: *15*.
- **Результаты**:
  - **LSTM**: точность *87%*, **TPR (полнота) 81%**.
  - **Bi-LSTM**: чуть ниже LSTM по точности.
  - **GRU**: быстрее обучается, но точность ниже.

## **5. Выводы**
- Метод RNN позволяет классифицировать DGA-домены без необходимости в контекстной информации и ручном извлечении признаков.
- Классификатор можно легко адаптировать к новым семействам DGA.
- RNN-модель легко внедряется в инфраструктуру, поскольку требует только анализа доменного имени.
- Будущие исследования будут направлены на улучшение работы с **TLD-информацией** и детекцию **словесных (dictionary-based) DGA**.

---

# **Выделенная проблема**
- **Существующие методы обнаружения DGA-доменов (обратная разработка, черные списки, статистический анализ) либо трудозатратны, либо требуют контекстных данных, либо подвержены обходу злоумышленниками.**
- **Даже машинное обучение с ручными признаками можно обойти, если злоумышленник будет учитывать известные характеристики легитимных доменов.**

# **Возможные пути улучшения**
1. **Комбинация RNN с CNN** – свертка может выявлять локальные паттерны в доменных именах, а RNN – их глобальные зависимости.
2. **Учет TLD (верхнеуровневых доменов)** – многие DGA-домены используют редкие или случайные TLD.
3. **Включение механизмов аномалий в потоках DNS-запросов** – учет частоты запросов к подозрительным доменам.
4. **Использование ансамблей моделей** – объединение RNN с градиентным бустингом или случайным лесом для повышения точности.
5. **Добавление метаданных (если возможно)** – например, время регистрации домена или IP-адрес сервера.

Таким образом, предлагаемая модель эффективна, но ее можно сделать еще более устойчивой к новым типам DGA-атак.
